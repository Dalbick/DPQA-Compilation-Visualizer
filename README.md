# OLSQ-DPQA Compiler ([ArXiv](https://arxiv.org/abs/2306.03487))
Optimal Layout Synthesizer of Quantum Circuits for Dynamically Field-Programmable Qubits Array.
Open source under the BSD 3-Clause license.

Repo structure:
- `run.py` is an example of using the compiler. Refer to `python run.py -h` for options.
- `solve.py` contains the class `DPQA` where we encode the compilation problem to SMT, and use `z3-solver` to solve it.
- `graphs.json` contains all the random 3-regular graphs we used. They are generated by `networkx`.
- `animation.py` contains the class `CodeGen` that generates DPQA instructions (five types `init`, `rydberg`, `activate`, `deactivate`, and `move`), and the class `Animator` that generates animations from DPQA instructions. Refer to `python animation.py -h` for options.
- `get_dpqa_duration.py` generates code files containing DPQA instructions from the SMT results to collect statistics. Refer to `python get_dpqa_duration.py -h` for options.
- `draw.py` generates the figures used in the paper and also calculates some statistics. It takes one necessary argument `small` or `large`. Refer to `python draw.py -h` for options.
- `results/` contains results used in the evaluation of the paper.
  - `results/smt/` contains the output of SMT variable assignments.
  - `results/stats/` contains the statistics of results of compilers (OLSQ-DPQA and others).
  - `results/code/` contains the code files generated from SMT output.
  - `results/animations/` contains a few example animations generated from code files.
  - `results/figures/` contains the figures in the paper.

How to reproduce the experiments:
- We used a Python 3 environment with `z3-solver==4.12.1.0`, `networkx==3.0`, and `python-sat==0.1.8.dev1`, and `matplotlib==3.6.2`. The Python scripts are run in the root directory of the repo.
- Run `python run.py <S> <I> --dir <D>` where 
  - `<S>` in `[10, 12, 14, 16, 18, 20, 22, 30, 40, 50, 60, 70, 80, 90]`,
  - `<I>` in `[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]`,
  - `<D>` is the directory to save the output. Do not forget the `/` at the end of `<D>`.
- As discussed in the appendix of the paper, graphs `S_I` in `[20_5, 22_5, 22_8, 80_1, 90_0, 90_2, 90_6, 90_8, 90_9]` timed out in our experiments and were not included in the data for the figures.
- Run `python get_dpqa_duration.py --dir <D>` to generate code files in `./animations` and collect statistics of OLSQ-DPQA results.
- Run `python draw.py small` and `python draw.py large`. The numbers we used in the paper will be printed out and the figures will be generated.
- (Optional) To generate animation, run `python animation.py <F>` where `<F>` is the SMT output file, e.g., `results/smt/rand3reg_90_1.json`.